<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Modern Budget Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .fade-in {
      animation: fadeIn 0.3s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <div class="container mx-auto px-4 py-8 max-w-5xl">
    <!-- Navigation and Header -->
    <nav class="flex justify-between items-center mb-8">
      <div class="flex items-center space-x-4">
        <a href="index.html" 
           class="inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition duration-200">
          <svg xmlns="http://www.w3.org/2000/svg" 
               class="h-5 w-5 mr-2" 
               viewBox="0 0 20 20" 
               fill="currentColor">
            <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
          </svg>
          Back to Home
        </a>
        <h1 class="text-3xl font-bold text-gray-800">Budget Tracker</h1>
      </div>
      <button onclick="clearAllData()" 
              class="px-4 py-2 text-red-600 hover:text-red-800 text-sm font-medium transition duration-200">
        Reset All Data
      </button>
    </nav>
    
    <!-- Income Sources Section -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-semibold text-gray-800">Income Sources</h2>
        <button type="button" 
                onclick="addIncomeRow()"
                class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-md transition duration-200">
          Add Income Source
        </button>
      </div>
      
      <div class="overflow-x-auto">
        <table id="incomeTable" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Source Name</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Frequency</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Monthly Total</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            <!-- Income rows will be added here -->
          </tbody>
        </table>
      </div>
    </div>
    
    <!-- Expenses Section -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-semibold text-gray-800">Expenses</h2>
        <button type="button" 
                onclick="addExpenseRow()"
                class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-md transition duration-200">
          Add Expense
        </button>
      </div>
      
      <div class="overflow-x-auto">
        <table id="expenseTable" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Expense Name</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total Amount</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Your Portion (%)</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Monthly</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Per Paycheck</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            <!-- Expense rows will be added here -->
          </tbody>
        </table>
      </div>
    </div>
    
    <!-- Results section -->
    <div class="grid md:grid-cols-4 gap-6 mt-8">
      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-lg font-bold text-gray-800 mb-1">Total Monthly Income</h3>
        <p id="monthlyIncome" class="text-3xl font-bold text-green-600">$0.00</p>
      </div>
      
      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-lg font-bold text-gray-800 mb-1">Monthly Expenses</h3>
        <p id="monthlyExpenses" class="text-3xl font-bold text-red-600">$0.00</p>
      </div>
      
      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-lg font-bold text-gray-800 mb-1">Average Per Paycheck</h3>
        <p id="averagePaycheck" class="text-3xl font-bold text-blue-600">$0.00</p>
      </div>

      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-lg font-bold text-gray-800 mb-1">Leftover Per Paycheck</h3>
        <p id="leftoverPerPaycheck" class="text-3xl font-bold text-purple-600">$0.00</p>
      </div>
    </div>
  </div>

  <script>
    const STORAGE_KEY = 'budgetTrackerData';
    const incomeTableBody = document.querySelector('#incomeTable tbody');
    const expenseTableBody = document.querySelector('#expenseTable tbody');
    
    // Load saved data when page loads
    document.addEventListener('DOMContentLoaded', loadSavedData);
    
    function loadSavedData() {
      const savedData = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{"incomes":[],"expenses":[]}');
      
      // Clear existing rows first
      incomeTableBody.innerHTML = '';
      expenseTableBody.innerHTML = '';
      
      if (savedData.incomes && savedData.incomes.length > 0) {
        savedData.incomes.forEach(income => {
          addIncomeRow(income);
        });
      } else {
        addIncomeRow(); // Add one empty income row
      }
      
      if (savedData.expenses && savedData.expenses.length > 0) {
        savedData.expenses.forEach(expense => {
          addExpenseRow(expense);
        });
      } else {
        addExpenseRow(); // Add one empty expense row
      }
      
      calculateBudget();
    }
    
    function saveData() {
      const data = {
        incomes: [],
        expenses: []
      };
      
      // Save income data
      incomeTableBody.querySelectorAll('tr').forEach(row => {
        const nameInput = row.querySelector('.incomeName');
        const amountInput = row.querySelector('.incomeAmount');
        const frequencySelect = row.querySelector('.incomeFrequency');
        
        if (nameInput && amountInput && frequencySelect) {
          data.incomes.push({
            name: nameInput.value || '',
            amount: amountInput.value || '',
            frequency: frequencySelect.value || 'monthly'
          });
        }
      });
      
      // Save expense data
      expenseTableBody.querySelectorAll('tr').forEach(row => {
        const nameInput = row.querySelector('.expenseName');
        const totalInput = row.querySelector('.totalExpense');
        const portionInput = row.querySelector('.yourPortion');
        
        if (nameInput && totalInput && portionInput) {
          data.expenses.push({
            name: nameInput.value || '',
            total: totalInput.value || '',
            portion: portionInput.value || ''
          });
        }
      });
      
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    }
    
    function clearAllData() {
      if (confirm('Are you sure you want to reset all data? This cannot be undone.')) {
        localStorage.removeItem(STORAGE_KEY);
        location.reload();
      }
    }
    
    function addIncomeRow(savedIncome = null) {
      const row = document.createElement('tr');
      row.className = 'fade-in';
      
      const inputs = {
        name: savedIncome ? savedIncome.name : '',
        amount: savedIncome ? savedIncome.amount : '',
        frequency: savedIncome ? savedIncome.frequency : 'monthly'
      };
      
      row.innerHTML = `
        <td class="px-6 py-4 whitespace-nowrap">
          <input type="text" 
                 class="incomeName w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" 
                 value="${inputs.name}"
                 placeholder="Enter income source">
        </td>
        <td class="px-6 py-4 whitespace-nowrap">
          <div class="relative">
            <span class="absolute left-3 top-2 text-gray-500">$</span>
            <input type="number" 
                   class="incomeAmount pl-8 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" 
                   value="${inputs.amount}"
                   step="0.01" 
                   placeholder="0.00">
          </div>
        </td>
        <td class="px-6 py-4 whitespace-nowrap">
          <select class="incomeFrequency w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                  value="${inputs.frequency}">
            <option value="weekly">Weekly (4 per month)</option>
            <option value="biweekly">Every other week (2 per month)</option>
            <option value="monthly">Monthly (1 per month)</option>
            <option value="annually">Annually</option>
          </select>
        </td>
        <td class="px-6 py-4 whitespace-nowrap">
          <span class="monthlyIncomeTotal text-sm text-gray-900">$0.00</span>
        </td>
        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
          <button onclick="removeIncomeRow(this)" 
                  class="text-red-600 hover:text-red-900 mr-2">
            Delete
          </button>
        </td>
      `;
      
      incomeTableBody.appendChild(row);
      
      // Set the frequency select value after a short delay to ensure the element is in the DOM
      setTimeout(() => {
        const frequencySelect = row.querySelector('.incomeFrequency');
        if (frequencySelect) {
          frequencySelect.value = inputs.frequency;
        }
      }, 0);
      
      // Add input event listeners
      row.querySelectorAll('input, select').forEach(input => {
        input.addEventListener('input', () => {
          calculateBudget();
          saveData();
        });
        input.addEventListener('change', () => {
          calculateBudget();
          saveData();
        });
      });
    }
    
    function removeIncomeRow(button) {
      const row = button.closest('tr');
      row.style.opacity = '0';
      row.style.transform = 'translateY(10px)';
      row.style.transition = 'all 0.3s ease-out';
      
      setTimeout(() => {
        row.remove();
        calculateBudget();
        saveData();
      }, 300);
    }
    
    function addExpenseRow(savedExpense = null) {
      const row = document.createElement('tr');
      row.className = 'fade-in';
      
      const inputs = {
        name: savedExpense ? savedExpense.name : '',
        total: savedExpense ? savedExpense.total : '',
        portion: savedExpense ? savedExpense.portion : ''
      };
      
      row.innerHTML = `
        <td class="px-6 py-4 whitespace-nowrap">
          <input type="text" 
                 class="expenseName w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" 
                 value="${inputs.name}"
                 placeholder="Enter expense name">
        </td>
        <td class="px-6 py-4 whitespace-nowrap">
          <div class="relative">
            <span class="absolute left-3 top-2 text-gray-500">$</span>
            <input type="number" 
                   class="totalExpense pl-8 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" 
                   value="${inputs.total}"
                   step="0.01" 
                   placeholder="0.00">
          </div>
        </td>
        <td class="px-6 py-4 whitespace-nowrap">
          <div class="relative">
            <input type="number" 
                   class="yourPortion w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" 
                   value="${inputs.portion}"
                   step="0.01" 
                   placeholder="0">
            <span class="absolute right-3 top-2 text-gray-500">%</span>
          </div>
        </td>
        <td class="px-6 py-4 whitespace-nowrap">
          <span class="monthlyExpense text-sm text-gray-900">$0.00</span>
        </td>
        <td class="px-6 py-4 whitespace-nowrap">
          <span class="perPaycheckExpense text-sm text-gray-900">$0.00</span>
        </td>
        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
          <button onclick="removeExpenseRow(this)" 
                  class="text-red-600 hover:text-red-900 mr-2">
            Delete
          </button>
        </td>
      `;
      
      expenseTableBody.appendChild(row);
      
      // Add input event listeners
      row.querySelectorAll('input').forEach(input => {
        input.addEventListener('input', () => {
          calculateBudget();
          saveData();
        });
      });
    }
    
    function removeExpenseRow(button) {
      const row = button.closest('tr');
      row.style.opacity = '0';
      row.style.transform = 'translateY(10px)';
      row.style.transition = 'all 0.3s ease-out';
      
      setTimeout(() => {
        row.remove();
        calculateBudget();
        saveData();
      }, 300);
    }
    
    function getMonthlyAmount(amount, frequency) {
      const amount_num = parseFloat(amount) || 0;
      switch(frequency) {
        case 'weekly': return amount_num * 4;
        case 'biweekly': return amount_num * 2;
        case 'monthly': return amount_num;
        case 'annually': return amount_num / 12;
        default: return amount_num;
      }
    }
    
    function calculateBudget() {
      let totalMonthlyIncome = 0;
      let totalMonthlyExpenses = 0;
      
      // Calculate total monthly income from all sources
      incomeTableBody.querySelectorAll('tr').forEach(row => {
        const amount = parseFloat(row.querySelector('.incomeAmount').value) || 0;
        const frequency = row.querySelector('.incomeFrequency').value;
        const monthlyAmount = getMonthlyAmount(amount, frequency);
        totalMonthlyIncome += monthlyAmount;
        
        const monthlyTotalElement = row.querySelector('.monthlyIncomeTotal');
        if (monthlyTotalElement) {
          monthlyTotalElement.textContent = `$${monthlyAmount.toFixed(2)}`;
        }
      });
      
      // Calculate expenses
      expenseTableBody.querySelectorAll('tr').forEach(row => {
        const totalExpense = parseFloat(row.querySelector('.totalExpense').value) || 0;
        const yourPortionPercent = parseFloat(row.querySelector('.yourPortion').value) || 0;
        
        const yourMonthlyExpense = totalExpense * (yourPortionPercent / 100);
        totalMonthlyExpenses += yourMonthlyExpense;
        
        const perPaycheckExpense = yourMonthlyExpense / 2; // Assuming biweekly payments
        
        const monthlyElement = row.querySelector('.monthlyExpense');
        const paycheckElement = row.querySelector('.perPaycheckExpense');
        
        if (monthlyElement) {
          monthlyElement.textContent = `$${yourMonthlyExpense.toFixed(2)}`;
        }
        if (paycheckElement) {
          paycheckElement.textContent = `$${perPaycheckExpense.toFixed(2)}`;
        }
      });
      
      // Calculate per-paycheck amounts
      const averagePaycheck = totalMonthlyIncome / 2; // Assuming biweekly payments
      const leftoverPerPaycheck = (totalMonthlyIncome - totalMonthlyExpenses) / 2;
      
      // Update the summary cards
      document.getElementById('monthlyIncome').textContent = `$${totalMonthlyIncome.toFixed(2)}`;
      document.getElementById('monthlyExpenses').textContent = `$${totalMonthlyExpenses.toFixed(2)}`;
      document.getElementById('averagePaycheck').textContent = `$${averagePaycheck.toFixed(2)}`;
      document.getElementById('leftoverPerPaycheck').textContent = `$${leftoverPerPaycheck.toFixed(2)}`;
    }
  </script>
</body>
</html>